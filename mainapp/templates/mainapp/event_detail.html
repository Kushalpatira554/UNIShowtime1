{% extends "base.html" %}
{% block content %}
<div class="min-h-screen py-12 px-4 sm:px-6 lg:px-8" style="background: linear-gradient(135deg, #0f172a, #1e293b, #334155);">
    <div class="max-w-4xl mx-auto rounded-xl shadow-2xl overflow-hidden" style="background: rgba(31, 64, 55, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(118, 199, 183, 0.3);">
        <!-- Event Header -->
        <div class="relative">
            {% if event.image %}
            <img src="{{ event.image.url }}" alt="{{ event.title }}" class="w-full h-64 object-cover">
            {% else %}
            <div class="w-full h-64 flex items-center justify-center" style="background: rgba(57, 72, 103, 0.6);">
                <i class="fas fa-calendar-alt text-6xl" style="color: #94B4C1;"></i>
            </div>
            {% endif %}
            <div class="absolute bottom-0 left-0 right-0 p-6" style="background: linear-gradient(to top, rgba(15, 23, 42, 0.9), transparent);">
                <h1 class="text-4xl font-bold" style="color: #d4f1f4;">{{ event.title }}</h1>
                <span class="inline-block mt-2 px-3 py-1 text-sm font-semibold rounded-full" style="background: rgba(118, 199, 183, 0.9); color: #213448;">{{ event.category }}</span>
            </div>
        </div>

        <!-- Event Details -->
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Left Column: Event Info -->
                <div class="space-y-4">
                    <div style="color: #d4f1f4;">
                        <h3 class="text-xl font-semibold mb-2" style="color: #76c7b7;">About the Event</h3>
                        <p>{{ event.description }}</p>
                    </div>
                    <div class="flex items-center" style="color: #94B4C1;">
                        <i class="far fa-calendar mr-2"></i>
                        <span>{{ event.date|date:"F j, Y - g:i A" }}</span>
                    </div>
                    <div class="flex items-center" style="color: #94B4C1;">
                        <i class="fas fa-map-marker-alt mr-2"></i>
                        <span>{{ event.location }}</span>
                    </div>
                    <div class="flex items-center" style="color: #94B4C1;">
                        <i class="fas fa-users mr-2"></i>
                        <span>{{ event.tickets_left }} tickets available</span>
                    </div>
                </div>

                <!-- Right Column: Ticket Purchase -->
                <div class="p-6 rounded-lg" style="background: rgba(57, 72, 103, 0.6); border: 1px solid rgba(148, 180, 193, 0.2);">
                    <h3 class="text-xl font-semibold mb-4" style="color: #76c7b7;">Ticket Information</h3>
                    {% if event.is_free %}
                        <p class="text-2xl font-bold mb-4" style="color: #d4f1f4;">Free Entry</p>
                    {% else %}
                        <p class="text-2xl font-bold mb-4" style="color: #d4f1f4;">â‚¹{{ event.ticket_price }}</p>
                    {% endif %}

                    {% if event.tickets_left > 0 %}
                        {% if user.is_authenticated %}
                            {% if not user_has_ticket %}
                                <form method="post" action="{% url 'book_ticket' event.id %}" class="space-y-4">
                                    {% csrf_token %}
                                    {% if not event.is_free %}
                                        <div class="p-4 rounded-lg mb-4" style="background: rgba(57, 72, 103, 0.8); border: 1px solid rgba(148, 180, 193, 0.2);">
                                            <h4 class="text-sm font-medium mb-2" style="color: #d4f1f4;">Payment Details</h4>
                                            <!-- Add payment form fields here -->
                                            <div class="space-y-2">
                                                <input type="text" name="card_number" placeholder="Card Number" class="w-full px-3 py-2 rounded border focus:outline-none focus:border-transparent" style="background: rgba(15, 23, 42, 0.8); border-color: rgba(148, 180, 193, 0.3); color: #d4f1f4;" onfocus="this.style.borderColor='#76c7b7'">
                                                <div class="grid grid-cols-2 gap-2">
                                                    <input type="text" name="expiry" placeholder="MM/YY" class="px-3 py-2 rounded border focus:outline-none focus:border-transparent" style="background: rgba(15, 23, 42, 0.8); border-color: rgba(148, 180, 193, 0.3); color: #d4f1f4;" onfocus="this.style.borderColor='#76c7b7'">
                                                    <input type="text" name="cvv" placeholder="CVV" class="px-3 py-2 rounded border focus:outline-none focus:border-transparent" style="background: rgba(15, 23, 42, 0.8); border-color: rgba(148, 180, 193, 0.3); color: #d4f1f4;" onfocus="this.style.borderColor='#76c7b7'">
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <button type="submit" class="w-full py-3 px-4 rounded-lg font-medium transition-all duration-300 transform hover:scale-105 flex items-center justify-center" style="background: linear-gradient(135deg, rgba(118, 199, 183, 0.9), rgba(153, 242, 200, 0.8)); color: #213448; border: 1px solid rgba(118, 199, 183, 0.3);">
                                        <i class="fas fa-ticket-alt mr-2"></i>
                                        {% if event.is_free %}Book Free Ticket{% else %}Purchase Ticket{% endif %}
                                    </button>
                                </form>
                            {% else %}
                                <div class="text-center">
                                    <p class="mb-4" style="color: #76c7b7;">You already have a ticket for this event!</p>
                                    <a href="{% url 'qr_view' user_ticket.id %}" class="inline-block py-2 px-4 rounded-lg font-medium transition-all duration-300 transform hover:scale-105" style="background: linear-gradient(135deg, rgba(118, 199, 183, 0.9), rgba(153, 242, 200, 0.8)); color: #213448;">
                                        <i class="fas fa-qrcode mr-2"></i>View Ticket
                                    </a>
                                </div>
                            {% endif %}
                        {% else %}
                            <div class="text-center">
                                <p class="mb-4" style="color: #94B4C1;">Please log in to book tickets</p>
                                <a href="{% url 'login' %}?next={{ request.path }}" class="inline-block py-2 px-4 rounded-lg font-medium transition-all duration-300 transform hover:scale-105" style="background: linear-gradient(135deg, rgba(118, 199, 183, 0.9), rgba(153, 242, 200, 0.8)); color: #213448;">
                                    <i class="fas fa-sign-in-alt mr-2"></i>Log In
                                </a>
                            </div>
                        {% endif %}
                    {% else %}
                        <p class="text-center" style="color: rgba(255, 99, 132, 0.8);">Sorry, this event is sold out!</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}