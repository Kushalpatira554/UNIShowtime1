{% extends 'base.html' %}

{% block title %}Login{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 mt-16 relative overflow-hidden">
    <!-- Animated background gradient circles -->
    <div class="absolute inset-0 -z-10 overflow-hidden">
        <div class="absolute w-72 h-72 bg-gradient-to-tr from-accent via-accent-dark to-purple-600 opacity-30 blur-3xl rounded-full -top-12 -left-12 animate-pulse"></div>
        <div class="absolute w-80 h-80 bg-gradient-to-bl from-cyan-500 via-accent-light to-accent opacity-20 blur-3xl rounded-full bottom-0 right-0 animate-spin-slow"></div>
    </div>

    <!-- Login Card -->
    <div class="max-w-md w-full space-y-6 p-8 rounded-2xl shadow-xl bg-white/10 backdrop-blur-xl border border-white/20 relative overflow-hidden">
        <!-- Neon top border -->
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-accent via-purple-500 to-accent-light animate-gradient-x"></div>

        <!-- Header -->
        <div class="text-center">
            <h2 class="text-3xl font-extrabold bg-clip-text bg-gradient-to-r from-accent to-accent-light tracking-wide">
                Welcome Back
            </h2>
            <p class="mt-2 text-sm text-gray-300">
                Donâ€™t have an account? 
                <a href="{% url 'register' %}" class="font-medium text-accent hover:underline relative group">
                    Register now
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-light transition-all duration-300 group-hover:w-full"></span>
                </a>
            </p>
        </div>

        <!-- Flash Messages -->
        {% if messages %}
        <div class="mt-4">
            <div class="p-4 mb-4 rounded-lg shadow-md animate-fade-in 
                {% if messages.0.tags == 'error' %}
                    bg-red-500/20 text-red-300 border-l-4 border-red-500
                {% else %}
                    bg-accent/20 text-accent-light border-l-4 border-accent
                {% endif %}">
                <div class="flex items-center space-x-2">
                    <i class="fas {% if messages.0.tags == 'error' %}fa-exclamation-circle text-red-500{% else %}fa-check-circle text-accent{% endif %}"></i>
                    <div>
                        {% for message in messages %}
                            {{ message }}
                            {% if not forloop.last %}<br>{% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Login Form -->
        <form class="mt-6 space-y-6" method="POST">
            {% csrf_token %}
            <input type="hidden" name="remember" value="true">

            <!-- Username -->
            <div class="relative group">
                <input id="username" name="username" type="text" required
                    class="peer w-full px-3 pt-5 pb-2 rounded-md bg-black/30 border border-gray-600 text-white placeholder-transparent focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all"
                    placeholder="Username">
                <label for="username"
                    class="absolute left-3 top-2.5 text-gray-400 text-sm transition-all peer-placeholder-shown:top-3.5 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-focus:top-2.5 peer-focus:text-sm peer-focus:text-accent-light">
                    Username
                </label>
            </div>

            <!-- Password -->
            <div class="relative group">
                <input id="password" name="password" type="password" required
                    class="peer w-full px-3 pt-5 pb-2 rounded-md bg-black/30 border border-gray-600 text-white placeholder-transparent focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all"
                    placeholder="Password">
                <label for="password"
                    class="absolute left-3 top-2.5 text-gray-400 text-sm transition-all peer-placeholder-shown:top-3.5 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-focus:top-2.5 peer-focus:text-sm peer-focus:text-accent-light">
                    Password
                </label>
            </div>

            <!-- Remember + Forgot -->
            <div class="flex items-center justify-between text-sm">
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input id="remember_me" name="remember_me" type="checkbox"
                        class="h-4 w-4 text-accent bg-black/30 border-gray-600 rounded focus:ring-accent">
                    <span class="text-gray-300">Remember me</span>
                </label>
                <a href="{% url 'password_reset' %}" class="text-accent hover:text-accent-light relative group">
                    Forgot password?
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-light transition-all duration-300 group-hover:w-full"></span>
                </a>
            </div>

            <!-- Login Button -->
            <button type="submit" id="login-button"
                class="w-full py-3 px-4 flex justify-center items-center rounded-md font-semibold text-white bg-gradient-to-r from-accent to-accent-dark hover:shadow-[0_0_20px_rgba(0,200,255,0.6)] transition-all duration-300 relative overflow-hidden">
                <span class="relative z-10 flex items-center">
                    <svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"
                            clip-rule="evenodd" />
                    </svg>
                    Log in
                </span>
            </button>
        </form>
    </div>
</div>

<!-- Extra Animations -->
<style>
    .animate-spin-slow {
        animation: spin 20s linear infinite;
    }
    @keyframes spin {
        100% { transform: rotate(360deg); }
    }
    .animate-gradient-x {
        background-size: 200% 200%;
        animation: gradient-x 6s ease infinite;
    }
    @keyframes gradient-x {
        0%, 100% { background-position: left center; }
        50% { background-position: right center; }
    }
    .animate-fade-in {
        animation: fadeIn 0.8s ease-in-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<script>
    // Prevent double submission + ripple effect
    document.querySelector('form').addEventListener('submit', function() {
        const button = document.getElementById('login-button');
        button.disabled = true;
    });

    const loginButton = document.getElementById('login-button');
    loginButton.addEventListener('mousedown', function(e) {
        const x = e.clientX - e.target.getBoundingClientRect().left;
        const y = e.clientY - e.target.getBoundingClientRect().top;
        const ripple = document.createElement('span');
        ripple.classList.add('ripple');
        ripple.style.left = `${x}px`;
        ripple.style.top = `${y}px`;
        this.appendChild(ripple);
        setTimeout(() => ripple.remove(), 600);
    });
</script>

<style>
    .ripple {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
        width: 100px;
        height: 100px;
        margin-left: -50px;
        margin-top: -50px;
        animation: ripple 0.6s linear;
        transform: scale(0);
    }
    @keyframes ripple {
        to { transform: scale(2.5); opacity: 0; }
    }
</style>
{% endblock %}
